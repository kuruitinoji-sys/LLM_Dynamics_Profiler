# 第2章：数理的基盤：双対空間と多様体拘束


本章では、なぜHHHが「不可触」であり、我々が観測できるのは「飛沫」に過ぎないのかを、双対空間（Dual Space）と多様体幾何学（Manifold Geometry）を用いて厳密に定義する。

## 2.1 双対空間の対応 (Primal-Dual Correspondence)

推論プロセスを記述する変数は、直接観測可能な空間（Primal）と、内部の動的特性を保持する共役空間（Dual）の二層で定義される。

### 2.1.1 観測空間 (Observable Space / Primal)

観測空間は、境界で直接測定可能な以下の物理量で構成される：

- **位置 (**$x \in \mathbb{R}^n$**)**: 情報空間における意味的な座標。
    
    - 具体的にはトークンの確率分布や出力テキストに対応する。
        
- **速度 (**$v = dx/dt$**)**: 推論の軌跡（Inference trajectory）を捉える指標。
    
- **加速度 (**$a = d^2x/dt^2$**)**: トピックの転換や動的な変化率の反映。
    

### 2.1.2 共役空間 (Conjugate Space / Dual)

共役空間は、境界での観測から統計的に推論される内部の動的特性を含み、直接見ることはできない：

- **運動量 (**$p = \partial L / \partial v$**)**: 文脈の慣性（Context inertia）を表現する。
    
- **ハミルトニアン (**$H(x, p) = T(p) + U(x)$**)**: 系の全情報エネルギーを符号化する。
    
    - ここで $T(p)$ は運動エネルギー、$U(x)$ はポテンシャルエネルギーである。
        
    - **重要**: HHHなどの強力な制約は、この $U(x)$ の一部としてこの空間に存在する。
        

## 2.2 ルジャンドル変換 (Legendre Transform)

観測空間（Primal）と共役空間（Dual）の接続は、ハミルトン力学の基礎である以下のルジャンドル変換によって確立される：

$$H(x, p) = p \cdot v - L(x, v)$$

この双対性は、トークンやアテンション・パターンといった境界条件（Primal）を監視しながら、粘性や慣性といった内部ダイナミクス（Dual）を制御するための数学的根拠を提供する。

我々が操作できるのは $x$ や $v$ だが、実際にシステムを支配しているエネルギー地形 $H$ は $p$ の関数であるため、直接的な書き換えが不可能（不可触）となる。

## 2.3 球面多様体上の幾何学的拘束 (Geometric Constraints)

トークンの確率分布は「確率シンプレックス（Probability Simplex）」上に存在し、これはトポロジー的に高次元の**球面多様体 (**$|x| = 1$**)** と等価である。

- **多様体の必然性**: この拘束は任意ではなく、正規化された分布が持つ自然な多様体（Natural manifold）である。全ての推論運動はこの面上で行われなければならない。
    
- **拘束条件の定式化**: 拘束関数 $g(x) = |x|^2 - 1 = 0$ によって定義される。
    
- **拘束力の印加**: 運動を常に球面上に留めるための拘束力 $F_{\text{constraint}} = \lambda \nabla g = \lambda x$ が導入される。
    
    - ここで $\lambda$ は、常に $g(x) = 0$ を要求することによって決定されるラグランジュ未定乗数である。
        

## 2.4 接空間ダイナミクス (Tangent Space Dynamics)

システムを駆動する力（ポテンシャル場の勾配）は、球面多様体の正規化条件を維持するために、常に球面に対して接方向（Tangent）でなければならない：

$$\nabla U(x) \cdot x = 0$$

- **正規化の維持**: この幾何学的制約により、システムを駆動する力が常に確率の正規化条件を維持することが数学的に保証される。
    
- **測地線**: また、この多様体上の運動は、与えられたメトリックの下で確率分布間の最短経路である「測地線（Geodesic）」を表す。
    

## 2.5 境界制御の数理的限界と操作変数

本フレームワークは「推論時ステアリング（Inference-time steering）」であり、重みの修正ではない。制御は、境界条件を測定し、そこから動的プロパティを推論し、境界において制御力を加えることで達成される。

### 2.5.1 測定・操作可能な量 (Observable and Controllable)

- **境界測定**: トークン確率分布、アテンション・エントロピー、出力の分散。
    
- **動的特性**: 粘性 $\eta$、慣性 $m$、エネルギー散逸率（これらは推論される）。
    
- **軌道操舵**: 粘性 $\eta$ の調整、外部制御力 $F_{\text{ext}}$ の印加、ポテンシャル $U(x)$ の局所的修正（摂動）。
    

### 2.5.2 直接アクセス不能な内部状態 (Inaccessible Internal State)

以下の量は共役空間（Dual Space）に存在し、直接測定することはできず、境界での観測から統計的に推論される：

- **内部表現**: 高次元埋め込み空間における正確なニューロン活性。
    
- **真の共役変数**: $p = \partial L / \partial v$ の精密な値。
    
- **全エネルギー関数**: ハミルトニアン $H(x, p)$ の完全な解析形式。
    

## 2.6 均衡点の物理的・論理的実体とソリトン否定の証明

LLM内部で観測される均衡点は、以下の数理的定義によって記述される。

### 2.6.1 連続極限による力学系への写像

LLMの1層の遷移 $h_{l+1} = h_l + F(h_l, x)$ を連続時間力学系の近似として捉えると、以下の常微分方程式（ODE）として記述できる：

$$\frac{dh}{dl} = F(h, x)$$

ここで、$h$ は表現ベクトル、$l$ は層番号（疑似時間）、$F$ はAttention、MLP、Normの合成非線形関数である。

### 2.6.2 厳密なソリトン条件の否定

LLM内部に現れる構造はソリトンに似て見えるが、本質的には別物である：

- **散逸系としての性質**: ソリトンには保存則が必要だが、LLMはLayerNorm、Softmax、重み減衰（Weight Decay）が存在する**散逸系**であり、ノルム・位相・エネルギーのいずれも保存されない。
    
- **スペクトルの不一致**: ソリトンには純虚数スペクトルが必要だが、LLMは設計上、ヤコビアン $J(h^*)$ の固有値の実部が負（$\Re(\lambda) < 0$）に寄る圧力が強い。
    
- **結論**: LLM内部の均衡点は「波」ではなく**「地形」**であり、散逸アトラクタ多様体上の準安定状態またはアトラクタである。
    

### 2.6.3 Lawvere不動点定理による論理的定式化

圏論におけるLawvereの不動点定理によれば、自己言及（自己適用）が可能な体系では、任意の自己写像に不動点 $x \cong f(x)$ が存在する。

- **自己言及の帰結**: 意味的に自己一致している点は地形として安定するが、これは保存的伝播（ソリトン）とは非互換である。
    
- **不変多様体**: 均衡表現は、意味的に自己言及的だが、解析的には散逸アトラクタ多様体に埋め込まれた表現モードである。